{"version":3,"sources":["../src/index.js","node_modules/p-try/index.js","node_modules/p-limit/index.js","index.ts"],"names":["loadedStates","whenDomReady","cb","doc","Promise","window","document","done","resolve","setTimeout","includes","readyState","addEventListener","resume","then","val","pTry","fn","arguments_","module","exports","default","require","pLimit","concurrency","Number","isInteger","Infinity","reject","TypeError","queue","activeCount","next","length","shift","run","args","result","enqueue","push","bind","generator","Object","defineProperties","get","pendingCount"],"mappings":"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","file":"fulcrum-ts.77de5100.js","sourceRoot":"..","sourcesContent":["/* eslint no-void: \"off\" */\n\n// Loaded ready states\nconst loadedStates = ['interactive', 'complete'];\n\n// Return Promise\nconst whenDomReady = (cb, doc) => new Promise(resolve => {\n\t// Allow doc to be passed in as the lone first param\n\tif (cb && typeof cb !== 'function') {\n\t\tdoc = cb;\n\t\tcb = null;\n\t}\n\n\t// Use global document if we don't have one\n\tdoc = doc || window.document;\n\n\t// Handle DOM load\n\tconst done = () => resolve(void (cb && setTimeout(cb)));\n\n\t// Resolve now if DOM has already loaded\n\t// Otherwise wait for DOMContentLoaded\n\tif (loadedStates.includes(doc.readyState)) {\n\t\tdone();\n\t} else {\n\t\tdoc.addEventListener('DOMContentLoaded', done);\n\t}\n});\n\n// Promise chain helper\nwhenDomReady.resume = doc => val => whenDomReady(doc).then(() => val);\n\nexport default whenDomReady;\n","'use strict';\n\nconst pTry = (fn, ...arguments_) => new Promise(resolve => {\n\tresolve(fn(...arguments_));\n});\n\nmodule.exports = pTry;\n// TODO: remove this in the next major version\nmodule.exports.default = pTry;\n","'use strict';\nconst pTry = require('p-try');\n\nconst pLimit = concurrency => {\n\tif (!((Number.isInteger(concurrency) || concurrency === Infinity) && concurrency > 0)) {\n\t\treturn Promise.reject(new TypeError('Expected `concurrency` to be a number from 1 and up'));\n\t}\n\n\tconst queue = [];\n\tlet activeCount = 0;\n\n\tconst next = () => {\n\t\tactiveCount--;\n\n\t\tif (queue.length > 0) {\n\t\t\tqueue.shift()();\n\t\t}\n\t};\n\n\tconst run = (fn, resolve, ...args) => {\n\t\tactiveCount++;\n\n\t\tconst result = pTry(fn, ...args);\n\n\t\tresolve(result);\n\n\t\tresult.then(next, next);\n\t};\n\n\tconst enqueue = (fn, resolve, ...args) => {\n\t\tif (activeCount < concurrency) {\n\t\t\trun(fn, resolve, ...args);\n\t\t} else {\n\t\t\tqueue.push(run.bind(null, fn, resolve, ...args));\n\t\t}\n\t};\n\n\tconst generator = (fn, ...args) => new Promise(resolve => enqueue(fn, resolve, ...args));\n\tObject.defineProperties(generator, {\n\t\tactiveCount: {\n\t\t\tget: () => activeCount\n\t\t},\n\t\tpendingCount: {\n\t\t\tget: () => queue.length\n\t\t}\n\t});\n\n\treturn generator;\n};\n\nmodule.exports = pLimit;\nmodule.exports.default = pLimit;\n","import whenDomReady from \"when-dom-ready\";\nimport pLimit from \"p-limit\";\nconst getIsRuntimeAdequate = () => {\n  const isFetchRunnable =\n    typeof window !== \"undefined\" && typeof window.fetch !== \"undefined\";\n  const isPromiseRunnable =\n    typeof window !== \"undefined\" && typeof window.Promise !== \"undefined\";\n  return isFetchRunnable && isPromiseRunnable;\n};\n\nconst fetchTests = () => fetch(\"http://localhost:8082/api/bucket\");\n\nconst getTestMap = async () => {\n  await whenDomReady();\n  const isRuntimeAdequate = getIsRuntimeAdequate();\n  if (!isRuntimeAdequate) {\n    throw new Error(\"Inadequate runtime!\");\n  }\n\n  const tests = await fetchTests();\n\n  console.log(\"bucket\", tests);\n\n  return new Map();\n};\n\nconst limit = pLimit(1);\nconst apply = () =>\n  limit(async () => {\n    const testMap = await getTestMap();\n    console.log(\"Map size\", testMap.size);\n  });\n\n// Globally exported functions\n(window as any).SweetSpot = {\n  apply,\n};\n"]}